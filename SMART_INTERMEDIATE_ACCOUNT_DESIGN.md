# ğŸ§  ØªØµÙ…ÙŠÙ… Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„ÙˆØ³ÙŠØ· Ø§Ù„Ø°ÙƒÙŠ (Smart Intermediate Account)

## ğŸ¯ Ø§Ù„Ù…ÙÙ‡ÙˆÙ… Ø§Ù„Ø¬Ø¯ÙŠØ¯

Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ ÙˆØ³ÙŠØ· Ù„ÙƒÙ„ Ø¹Ù„Ø§Ù‚Ø©ØŒ Ø³ÙŠÙƒÙˆÙ† Ù„ÙƒÙ„ **ÙˆØ­Ø¯Ø©** Ùˆ **Ù…Ø¤Ø³Ø³Ø©** Ø­Ø³Ø§Ø¨ ÙˆØ³ÙŠØ· ÙˆØ§Ø­Ø¯ ÙÙ‚Ø·ØŒ Ù…Ø¹ Ù†Ø¸Ø§Ù… ÙÙ„ØªØ±Ø© Ù…ØªÙ‚Ø¯Ù… Ù„ØªØªØ¨Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙØ§ØµÙŠÙ„.

---

## ğŸ“Š Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯

### 1ï¸âƒ£ **Ø­Ø³Ø§Ø¨ ÙˆØ³ÙŠØ· Ù„ÙƒÙ„ ÙˆØ­Ø¯Ø©**
```
Ø§Ù„ÙˆØ­Ø¯Ø© 1 â†’ Ø­Ø³Ø§Ø¨ ÙˆØ³ÙŠØ· ÙˆØ§Ø­Ø¯ (ÙƒÙˆØ¯: 1900)
Ø§Ù„ÙˆØ­Ø¯Ø© 2 â†’ Ø­Ø³Ø§Ø¨ ÙˆØ³ÙŠØ· ÙˆØ§Ø­Ø¯ (ÙƒÙˆØ¯: 1900)
Ø§Ù„ÙˆØ­Ø¯Ø© 3 â†’ Ø­Ø³Ø§Ø¨ ÙˆØ³ÙŠØ· ÙˆØ§Ø­Ø¯ (ÙƒÙˆØ¯: 1900)
```

### 2ï¸âƒ£ **Ø­Ø³Ø§Ø¨ ÙˆØ³ÙŠØ· Ù„ÙƒÙ„ Ù…Ø¤Ø³Ø³Ø©**
```
Ø§Ù„Ù…Ø¤Ø³Ø³Ø© 1 â†’ Ø­Ø³Ø§Ø¨ ÙˆØ³ÙŠØ· ÙˆØ§Ø­Ø¯ (ÙƒÙˆØ¯: 1950)
Ø§Ù„Ù…Ø¤Ø³Ø³Ø© 2 â†’ Ø­Ø³Ø§Ø¨ ÙˆØ³ÙŠØ· ÙˆØ§Ø­Ø¯ (ÙƒÙˆØ¯: 1950)
Ø§Ù„Ù…Ø¤Ø³Ø³Ø© 3 â†’ Ø­Ø³Ø§Ø¨ ÙˆØ³ÙŠØ· ÙˆØ§Ø­Ø¯ (ÙƒÙˆØ¯: 1950)
```

---

## ğŸ” Ù†Ø¸Ø§Ù… Ø§Ù„ÙÙ„ØªØ±Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…

### Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù…ØªØ§Ø­Ø©:

| Ø§Ù„ÙÙ„ØªØ± | Ø§Ù„ÙˆØµÙ | Ù…Ø«Ø§Ù„ |
|--------|-------|------|
| **Ù†ÙˆØ¹ Ø§Ù„Ø³Ù†Ø¯** | ØµØ±Ù/Ù‚Ø¨Ø¶/Ù‚ÙŠØ¯ ÙŠÙˆÙ…ÙŠØ© | `voucherType = 'payment'` |
| **Ù†ÙˆØ¹ Ø§Ù„ØªØ±Ø­ÙŠÙ„** | Ø¨ÙŠÙ† ÙˆØ­Ø¯Ø§Øª/Ù…Ø¤Ø³Ø³Ø§Øª | `transferType = 'unit_to_unit'` |
| **Ø§Ù„ÙƒÙŠØ§Ù† Ø§Ù„Ù…ØµØ¯Ø±** | Ù…Ù† Ø£ÙŠ ÙˆØ­Ø¯Ø©/Ù…Ø¤Ø³Ø³Ø© | `sourceUnitId = 1` |
| **Ø§Ù„ÙƒÙŠØ§Ù† Ø§Ù„Ù‡Ø¯Ù** | Ø¥Ù„Ù‰ Ø£ÙŠ ÙˆØ­Ø¯Ø©/Ù…Ø¤Ø³Ø³Ø© | `targetUnitId = 2` |
| **Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚** | Ø£ÙŠ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ø³ØªÙØ®Ø¯Ù… | `cashAccountId = 1010` |
| **Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ** | Ø§Ù„Ø­Ø³Ø§Ø¨ ÙÙŠ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø¢Ø®Ø± | `targetAccountId = 3010` |
| **Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©** | Ù…Ù† ØªØ§Ø±ÙŠØ® Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ® | `voucherDate BETWEEN '2025-01-01' AND '2025-01-31'` |
| **Ø§Ù„Ø­Ø§Ù„Ø©** | Ù…Ø¹Ù„Ù‚/Ù…ÙØ±Ø­Ù‘Ù„/Ù…Ø±ÙÙˆØ¶ | `status = 'transferred'` |
| **Ø§Ù„Ù…Ø¨Ù„Øº** | Ù†Ø·Ø§Ù‚ Ø§Ù„Ù…Ø¨Ù„Øº | `amount BETWEEN 10000 AND 50000` |
| **Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©** | Ù…Ù†Ø®ÙØ¶/Ù…ØªÙˆØ³Ø·/Ø¹Ø§Ù„ÙŠ/Ø¹Ø§Ø¬Ù„ | `priority = 'high'` |
| **Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…** | Ù…Ù† Ø£Ù†Ø´Ø£/Ø±Ø­Ù‘Ù„ Ø§Ù„Ø³Ù†Ø¯ | `createdBy = 5` |

---

## ğŸ“‹ Ø¬Ø¯ÙˆÙ„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„ÙˆØ³ÙŠØ·

### Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯: `intermediate_account_transactions`

Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø¯ÙˆÙ„ ÙŠØ®Ø²Ù† **Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙØ§ØµÙŠÙ„** Ù„ÙƒÙ„ Ø¹Ù…Ù„ÙŠØ© ØªÙ…Ø± Ø¹Ø¨Ø± Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„ÙˆØ³ÙŠØ·:

```sql
CREATE TABLE intermediate_account_transactions (
    -- Ø§Ù„Ù…Ø¹Ø±Ù Ø§Ù„ÙØ±ÙŠØ¯
    id INT AUTO_INCREMENT PRIMARY KEY,
    
    -- Ø±Ø¨Ø· Ø¨Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„ÙˆØ³ÙŠØ·
    intermediateAccountId INT NOT NULL,
    
    -- Ø±Ø¨Ø· Ø¨Ø§Ù„Ø³Ù†Ø¯ Ø§Ù„Ù…Ø¹Ù„Ù‚
    pendingVoucherId INT NOT NULL,
    
    -- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø³Ù†Ø¯
    voucherType ENUM('payment', 'receipt', 'journal_entry') NOT NULL,
    transferType ENUM('unit_to_unit', 'company_to_company', 'unit_to_company', 'company_to_unit') NOT NULL,
    voucherNumber VARCHAR(50) NOT NULL,
    voucherDate DATE NOT NULL,
    amount DECIMAL(15,2) NOT NULL,
    description TEXT NOT NULL,
    
    -- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙƒÙŠØ§Ù† Ø§Ù„Ù…ØµØ¯Ø±
    sourceType ENUM('unit', 'company') NOT NULL,
    sourceUnitId INT NULL,
    sourceCompanyId INT NULL,
    sourceBranchId INT NULL,
    
    -- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙƒÙŠØ§Ù† Ø§Ù„Ù‡Ø¯Ù
    targetType ENUM('unit', 'company') NOT NULL,
    targetUnitId INT NULL,
    targetCompanyId INT NULL,
    targetBranchId INT NULL,
    
    -- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
    cashAccountId INT NULL COMMENT 'Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ø£Ùˆ Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…',
    cashAccountCode VARCHAR(20) NULL,
    cashAccountName VARCHAR(255) NULL,
    
    targetAccountId INT NULL COMMENT 'Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ ÙÙŠ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø¢Ø®Ø±',
    targetAccountCode VARCHAR(20) NULL,
    targetAccountName VARCHAR(255) NULL,
    
    -- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚ÙŠØ¯
    debitAccountId INT NOT NULL,
    debitAccountCode VARCHAR(20) NOT NULL,
    debitAccountName VARCHAR(255) NOT NULL,
    
    creditAccountId INT NOT NULL,
    creditAccountCode VARCHAR(20) NOT NULL,
    creditAccountName VARCHAR(255) NOT NULL,
    
    -- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ±Ø­ÙŠÙ„
    status ENUM('pending', 'transferred', 'rejected', 'cancelled') NOT NULL DEFAULT 'pending',
    isTransferred BOOLEAN NOT NULL DEFAULT FALSE,
    transferredAt DATETIME NULL,
    transferredBy INT NULL,
    
    -- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
    priority ENUM('low', 'medium', 'high', 'urgent') NOT NULL DEFAULT 'medium',
    notes TEXT NULL,
    
    -- Audit Trail
    createdBy INT NOT NULL,
    createdAt DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updatedAt DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    -- Foreign Keys
    CONSTRAINT fk_iat_intermediate_account FOREIGN KEY (intermediateAccountId) REFERENCES accounts(id),
    CONSTRAINT fk_iat_pending_voucher FOREIGN KEY (pendingVoucherId) REFERENCES pending_vouchers(id),
    CONSTRAINT fk_iat_source_unit FOREIGN KEY (sourceUnitId) REFERENCES units(id),
    CONSTRAINT fk_iat_source_company FOREIGN KEY (sourceCompanyId) REFERENCES companies(id),
    CONSTRAINT fk_iat_target_unit FOREIGN KEY (targetUnitId) REFERENCES units(id),
    CONSTRAINT fk_iat_target_company FOREIGN KEY (targetCompanyId) REFERENCES companies(id),
    CONSTRAINT fk_iat_cash_account FOREIGN KEY (cashAccountId) REFERENCES accounts(id),
    CONSTRAINT fk_iat_target_account FOREIGN KEY (targetAccountId) REFERENCES accounts(id),
    CONSTRAINT fk_iat_debit_account FOREIGN KEY (debitAccountId) REFERENCES accounts(id),
    CONSTRAINT fk_iat_credit_account FOREIGN KEY (creditAccountId) REFERENCES accounts(id),
    CONSTRAINT fk_iat_transferred_by FOREIGN KEY (transferredBy) REFERENCES users(id),
    CONSTRAINT fk_iat_created_by FOREIGN KEY (createdBy) REFERENCES users(id)
    
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Ø§Ù„ÙÙ‡Ø§Ø±Ø³
CREATE INDEX idx_iat_intermediate_account ON intermediate_account_transactions(intermediateAccountId);
CREATE INDEX idx_iat_voucher_type ON intermediate_account_transactions(voucherType);
CREATE INDEX idx_iat_transfer_type ON intermediate_account_transactions(transferType);
CREATE INDEX idx_iat_voucher_date ON intermediate_account_transactions(voucherDate);
CREATE INDEX idx_iat_status ON intermediate_account_transactions(status);
CREATE INDEX idx_iat_source_entity ON intermediate_account_transactions(sourceType, sourceUnitId, sourceCompanyId);
CREATE INDEX idx_iat_target_entity ON intermediate_account_transactions(targetType, targetUnitId, targetCompanyId);
CREATE INDEX idx_iat_cash_account ON intermediate_account_transactions(cashAccountId);
CREATE INDEX idx_iat_target_account ON intermediate_account_transactions(targetAccountId);
CREATE INDEX idx_iat_amount ON intermediate_account_transactions(amount);
CREATE INDEX idx_iat_priority ON intermediate_account_transactions(priority);
```

---

## ğŸ¨ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ÙÙ„ØªØ±Ø©

### ØµÙØ­Ø© "ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„ÙˆØ³ÙŠØ·"

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸ§  Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„ÙˆØ³ÙŠØ· Ø§Ù„Ø°ÙƒÙŠ - Ø§Ù„ÙˆØ­Ø¯Ø© 1                         â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                              â•‘
â•‘  ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø©:                                     â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘
â•‘  â”‚ Ù…Ø¹Ù„Ù‚: 15     â”‚ Ù…ÙØ±Ø­Ù‘Ù„: 45   â”‚ Ù…Ø±ÙÙˆØ¶: 2     â”‚ Ù…Ù„ØºÙŠ: 1    â”‚â•‘
â•‘  â”‚ 750,000 Ø±.Ø³  â”‚ 2,250,000 Ø±.Ø³â”‚ 100,000 Ø±.Ø³  â”‚ 50,000 Ø±.Ø³ â”‚â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘
â•‘                                                              â•‘
â•‘  ğŸ” Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©:                                        â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚ Ù†ÙˆØ¹ Ø§Ù„Ø³Ù†Ø¯:      [â–¼ Ø§Ù„ÙƒÙ„ â–¼]                            â”‚ â•‘
â•‘  â”‚ Ù†ÙˆØ¹ Ø§Ù„ØªØ±Ø­ÙŠÙ„:    [â–¼ Ø§Ù„ÙƒÙ„ â–¼]                            â”‚ â•‘
â•‘  â”‚ Ù…Ù† ÙˆØ­Ø¯Ø©/Ù…Ø¤Ø³Ø³Ø©:  [â–¼ Ø§Ù„ÙƒÙ„ â–¼]                            â”‚ â•‘
â•‘  â”‚ Ø¥Ù„Ù‰ ÙˆØ­Ø¯Ø©/Ù…Ø¤Ø³Ø³Ø©: [â–¼ Ø§Ù„ÙƒÙ„ â–¼]                            â”‚ â•‘
â•‘  â”‚ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚:        [â–¼ Ø§Ù„ÙƒÙ„ â–¼]                            â”‚ â•‘
â•‘  â”‚ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: [â–¼ Ø§Ù„ÙƒÙ„ â–¼]                            â”‚ â•‘
â•‘  â”‚ Ù…Ù† ØªØ§Ø±ÙŠØ®:       [ğŸ“… 2025-01-01]                        â”‚ â•‘
â•‘  â”‚ Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®:      [ğŸ“… 2025-01-31]                        â”‚ â•‘
â•‘  â”‚ Ø§Ù„Ø­Ø§Ù„Ø©:         [â–¼ Ø§Ù„ÙƒÙ„ â–¼]                            â”‚ â•‘
â•‘  â”‚ Ø§Ù„Ù…Ø¨Ù„Øº Ù…Ù†:      [_________] Ø¥Ù„Ù‰: [_________]          â”‚ â•‘
â•‘  â”‚ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©:       [â–¼ Ø§Ù„ÙƒÙ„ â–¼]                            â”‚ â•‘
â•‘  â”‚                                                        â”‚ â•‘
â•‘  â”‚ [ğŸ” Ø¨Ø­Ø«] [ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†]                             â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                              â•‘
â•‘  ğŸ“‹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ (45 Ø³Ù†Ø¯):                                       â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”â•‘
â•‘  â”‚ Ø±Ù‚Ù…  â”‚ Ø§Ù„ØªØ§Ø±ÙŠØ®â”‚ Ø§Ù„Ù†ÙˆØ¹    â”‚ Ù…Ù†       â”‚ Ø¥Ù„Ù‰      â”‚ Ø§Ù„Ù…Ø¨Ù„Øº â”‚â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤â•‘
â•‘  â”‚ SV-1 â”‚ 01/15  â”‚ ØµØ±Ù      â”‚ ÙˆØ­Ø¯Ø© 1   â”‚ ÙˆØ­Ø¯Ø© 2   â”‚ 50,000 â”‚â•‘
â•‘  â”‚ RV-2 â”‚ 01/16  â”‚ Ù‚Ø¨Ø¶      â”‚ Ù…Ø¤Ø³Ø³Ø© 1  â”‚ Ù…Ø¤Ø³Ø³Ø© 2  â”‚ 75,000 â”‚â•‘
â•‘  â”‚ ...  â”‚ ...    â”‚ ...      â”‚ ...      â”‚ ...      â”‚ ...    â”‚â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜â•‘
â•‘                                                              â•‘
â•‘  [ğŸ“Š ØªØµØ¯ÙŠØ± Excel] [ğŸ“„ Ø·Ø¨Ø§Ø¹Ø©] [ğŸ“ˆ ØªÙ‚Ø±ÙŠØ± Ù…ÙØµÙ„]               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ“Š Ø£Ù…Ø«Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª

### 1. Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø¹Ø¨Ø± Ø­Ø³Ø§Ø¨ ÙˆØ³ÙŠØ· Ù…Ø¹ÙŠÙ†

```sql
SELECT 
    iat.*,
    CASE iat.sourceType
        WHEN 'unit' THEN CONCAT('ÙˆØ­Ø¯Ø©: ', u1.unitName)
        WHEN 'company' THEN CONCAT('Ù…Ø¤Ø³Ø³Ø©: ', c1.companyName)
    END AS source,
    CASE iat.targetType
        WHEN 'unit' THEN CONCAT('ÙˆØ­Ø¯Ø©: ', u2.unitName)
        WHEN 'company' THEN CONCAT('Ù…Ø¤Ø³Ø³Ø©: ', c2.companyName)
    END AS target
FROM intermediate_account_transactions iat
LEFT JOIN units u1 ON iat.sourceUnitId = u1.id
LEFT JOIN companies c1 ON iat.sourceCompanyId = c1.id
LEFT JOIN units u2 ON iat.targetUnitId = u2.id
LEFT JOIN companies c2 ON iat.targetCompanyId = c2.id
WHERE iat.intermediateAccountId = 1900
ORDER BY iat.voucherDate DESC;
```

### 2. ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø³Ù†Ø¯ ÙˆØ§Ù„ÙØªØ±Ø©

```sql
SELECT * 
FROM intermediate_account_transactions
WHERE intermediateAccountId = 1900
  AND voucherType = 'payment'
  AND voucherDate BETWEEN '2025-01-01' AND '2025-01-31'
  AND status = 'transferred'
ORDER BY voucherDate DESC;
```

### 3. ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„ÙƒÙŠØ§Ù† Ø§Ù„Ù…ØµØ¯Ø± ÙˆØ§Ù„Ù‡Ø¯Ù

```sql
SELECT * 
FROM intermediate_account_transactions
WHERE intermediateAccountId = 1900
  AND sourceUnitId = 1
  AND targetUnitId = 2
  AND transferType = 'unit_to_unit'
ORDER BY voucherDate DESC;
```

### 4. ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…

```sql
SELECT * 
FROM intermediate_account_transactions
WHERE intermediateAccountId = 1900
  AND cashAccountId = 1010
  AND status = 'transferred'
ORDER BY voucherDate DESC;
```

### 5. ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ù†Ø·Ø§Ù‚ Ø§Ù„Ù…Ø¨Ù„Øº

```sql
SELECT * 
FROM intermediate_account_transactions
WHERE intermediateAccountId = 1900
  AND amount BETWEEN 10000 AND 50000
  AND status = 'pending'
ORDER BY amount DESC;
```

### 6. Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„ØªØ±Ø­ÙŠÙ„

```sql
SELECT 
    transferType,
    CASE transferType
        WHEN 'unit_to_unit' THEN 'Ø¨ÙŠÙ† Ø§Ù„ÙˆØ­Ø¯Ø§Øª'
        WHEN 'company_to_company' THEN 'Ø¨ÙŠÙ† Ø§Ù„Ù…Ø¤Ø³Ø³Ø§Øª'
        WHEN 'unit_to_company' THEN 'Ù…Ù† ÙˆØ­Ø¯Ø© Ù„Ù…Ø¤Ø³Ø³Ø©'
        WHEN 'company_to_unit' THEN 'Ù…Ù† Ù…Ø¤Ø³Ø³Ø© Ù„ÙˆØ­Ø¯Ø©'
    END AS transferTypeName,
    COUNT(*) AS count,
    SUM(amount) AS totalAmount,
    AVG(amount) AS avgAmount
FROM intermediate_account_transactions
WHERE intermediateAccountId = 1900
GROUP BY transferType;
```

### 7. Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© Ø­Ø³Ø¨ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©

```sql
SELECT 
    priority,
    COUNT(*) AS count,
    SUM(amount) AS totalAmount
FROM intermediate_account_transactions
WHERE intermediateAccountId = 1900
  AND status = 'pending'
GROUP BY priority
ORDER BY FIELD(priority, 'urgent', 'high', 'medium', 'low');
```

---

## ğŸ¤– Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ

### Ø£Ù…Ø«Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø¨Ø³ÙŠØ·Ø©:

```
âœ… "Ø£Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ù†Ø¯Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© ÙÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„ÙˆØ³ÙŠØ· Ù„Ù„ÙˆØ­Ø¯Ø© 1"
âœ… "Ø£Ø¹Ø±Ø¶ Ø§Ù„Ø³Ù†Ø¯Ø§Øª Ø§Ù„Ù…ÙØ±Ø­Ù‘Ù„Ø© Ø¨ÙŠÙ† Ø§Ù„ÙˆØ­Ø¯Ø© 1 ÙˆØ§Ù„ÙˆØ­Ø¯Ø© 2 ÙÙŠ ÙŠÙ†Ø§ÙŠØ± 2025"
âœ… "Ø£Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ØµØ±Ù Ù…Ù† Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø¹Ø¨Ø± Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„ÙˆØ³ÙŠØ·"
âœ… "Ø£Ø¹Ø±Ø¶ Ø§Ù„Ø³Ù†Ø¯Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø© Ø°Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© Ø§Ù„Ø¹Ø§Ù„ÙŠØ©"
âœ… "Ø£Ø¹Ø±Ø¶ Ø§Ù„Ø³Ù†Ø¯Ø§Øª Ø¨Ù…Ø¨Ù„Øº Ø£ÙƒØ«Ø± Ù…Ù† 50,000 Ø±ÙŠØ§Ù„"
âœ… "Ø£Ø¹Ø±Ø¶ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„ÙˆØ³ÙŠØ· Ù„Ù„Ù…Ø¤Ø³Ø³Ø© 1"
```

---

## ğŸ“ˆ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…ØªØ§Ø­Ø©

### 1. ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ø´Ù‡Ø±ÙŠØ©
```sql
SELECT 
    DATE_FORMAT(voucherDate, '%Y-%m') AS month,
    transferType,
    COUNT(*) AS count,
    SUM(amount) AS totalAmount
FROM intermediate_account_transactions
WHERE intermediateAccountId = 1900
  AND status = 'transferred'
GROUP BY month, transferType
ORDER BY month DESC, transferType;
```

### 2. ØªÙ‚Ø±ÙŠØ± Ø£ÙƒØ«Ø± Ø§Ù„ÙƒÙŠØ§Ù†Ø§Øª ØªØ¹Ø§Ù…Ù„Ø§Ù‹
```sql
SELECT 
    CASE targetType
        WHEN 'unit' THEN CONCAT('ÙˆØ­Ø¯Ø©: ', u.unitName)
        WHEN 'company' THEN CONCAT('Ù…Ø¤Ø³Ø³Ø©: ', c.companyName)
    END AS targetEntity,
    COUNT(*) AS transactionCount,
    SUM(amount) AS totalAmount
FROM intermediate_account_transactions iat
LEFT JOIN units u ON iat.targetUnitId = u.id
LEFT JOIN companies c ON iat.targetCompanyId = c.id
WHERE iat.intermediateAccountId = 1900
  AND iat.status = 'transferred'
GROUP BY targetEntity
ORDER BY totalAmount DESC
LIMIT 10;
```

### 3. ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø¯Ø§Ø¡ (Ù…ØªÙˆØ³Ø· ÙˆÙ‚Øª Ø§Ù„ØªØ±Ø­ÙŠÙ„)
```sql
SELECT 
    DATE_FORMAT(voucherDate, '%Y-%m') AS month,
    COUNT(*) AS totalTransactions,
    AVG(TIMESTAMPDIFF(HOUR, createdAt, transferredAt)) AS avgHoursToTransfer,
    MIN(TIMESTAMPDIFF(HOUR, createdAt, transferredAt)) AS minHoursToTransfer,
    MAX(TIMESTAMPDIFF(HOUR, createdAt, transferredAt)) AS maxHoursToTransfer
FROM intermediate_account_transactions
WHERE intermediateAccountId = 1900
  AND status = 'transferred'
  AND transferredAt IS NOT NULL
GROUP BY month
ORDER BY month DESC;
```

---

## âœ… Ø§Ù„ÙÙˆØ§Ø¦Ø¯

| Ø§Ù„Ù…ÙŠØ²Ø© | Ø§Ù„ÙˆØµÙ |
|--------|-------|
| **ØªØ¨Ø³ÙŠØ·** | Ø­Ø³Ø§Ø¨ ÙˆØ³ÙŠØ· ÙˆØ§Ø­Ø¯ Ù„ÙƒÙ„ ÙˆØ­Ø¯Ø©/Ù…Ø¤Ø³Ø³Ø© |
| **Ù…Ø±ÙˆÙ†Ø©** | ÙÙ„ØªØ±Ø© Ù…ØªÙ‚Ø¯Ù…Ø© Ø­Ø³Ø¨ Ø£ÙŠ Ù…Ø¹ÙŠØ§Ø± |
| **ÙˆØ¶ÙˆØ­** | ØªØªØ¨Ø¹ ÙƒØ§Ù…Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙØ§ØµÙŠÙ„ |
| **ØªÙ‚Ø§Ø±ÙŠØ±** | Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆØªÙ‚Ø§Ø±ÙŠØ± Ø´Ø§Ù…Ù„Ø© |
| **Ø£Ø¯Ø§Ø¡** | ÙÙ‡Ø§Ø±Ø³ Ù…Ø­Ø³Ù‘Ù†Ø© Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ø¨Ø­Ø« |
| **Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ** | Ø£ÙˆØ§Ù…Ø± Ø¨Ø³ÙŠØ·Ø© ÙˆÙ…Ø¨Ø§Ø´Ø±Ø© |

---

## ğŸ”„ Ø§Ù„ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ

### ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙˆÙ„ `accounts`:

```sql
-- Ø¥Ø¶Ø§ÙØ© Ø­Ù‚Ù„ Ù„ØªØ­Ø¯ÙŠØ¯ Ø£Ù† Ø§Ù„Ø­Ø³Ø§Ø¨ Ù‡Ùˆ Ø­Ø³Ø§Ø¨ ÙˆØ³ÙŠØ·
ALTER TABLE accounts 
ADD COLUMN isIntermediateAccount BOOLEAN DEFAULT FALSE COMMENT 'Ù‡Ù„ Ù‡Ø°Ø§ Ø­Ø³Ø§Ø¨ ÙˆØ³ÙŠØ·ØŸ';

-- Ø¥Ø¶Ø§ÙØ© ÙÙ‡Ø±Ø³
CREATE INDEX idx_is_intermediate ON accounts(isIntermediateAccount);
```

### Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„ÙˆØ³ÙŠØ·Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹:

```sql
-- Ø¹Ù†Ø¯ Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ­Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø©
INSERT INTO accounts (
    accountCode, accountName, accountType, 
    companyId, isIntermediateAccount, createdBy
) VALUES (
    '1900', 'Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„ÙˆØ³ÙŠØ· - Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©', 'current_asset',
    NULL, TRUE, 1
);

-- Ø¹Ù†Ø¯ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¤Ø³Ø³Ø© Ø¬Ø¯ÙŠØ¯Ø©
INSERT INTO accounts (
    accountCode, accountName, accountType, 
    companyId, isIntermediateAccount, createdBy
) VALUES (
    '1950', 'Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„ÙˆØ³ÙŠØ· - Ø§Ù„Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©', 'current_asset',
    :companyId, TRUE, 1
);
```

---

**ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡:** 2025-01-14  
**Ø§Ù„Ø¥ØµØ¯Ø§Ø±:** 1.0  
**Ø§Ù„Ø­Ø§Ù„Ø©:** âœ… Ø¬Ø§Ù‡Ø² Ù„Ù„ØªÙ†ÙÙŠØ°
